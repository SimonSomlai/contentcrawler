function submitHomeForm(){$("#scrape-form-home").on("submit",function(){console.log("submitted!"),$("#spinner").show();var e=$(this).serialize(),t=$("#scrape_job_url").val(),a=$("#datatable1").DataTable();window.table=a,$("#datatable1 tbody tr:first-child").remove();var n=new EventSource("/get-home-articles?"+e);window.event=n,$("html,body").animate({scrollTop:$("#section-features").offset().top-30},"slow"),$("#section-features>h2").text("Searching Articles From "+t),$(".url").text(t),$("#url").val(t);var o=0;return n.addEventListener("message",function(e){var t=a.rows().count(),n=t+1,s=JSON.parse(JSON.parse(e.data)),i=s.message,r=s.url,d=s.amount;if(s.error!=undefined&&(alert('Invalid website format. Use "http://www.mydomain.com/". Do not forget the last /'),location.reload()),i!=undefined){var c="";c+='  <div id="custom-notification-message-'+o+'" data-notify-close="true" data-notify-position="top-left" data-notify-type="success" data-notify-msg=\'<i class="icon-info-sign"></i> '+i+"'></div>",c+="",3==$("#messages #message-box").length&&$("#messages #message-box")[0].remove(),$("#messages").append(c),SEMICOLON.widget.notifications(jQuery("#custom-notification-message-"+o)),o+=1}r!=undefined&&a.row.add([n.toString(),"<a target='_blank' href='"+r.toString()+"'>"+r.toString()+"</a>","","","","","","",""]).draw(!1),d!=undefined&&$(".amount").text(d+" valid articles found!")},!1),n.addEventListener("error",function(e){e.eventPhase==EventSource.CLOSED&&(n.close(),$(".scrape-button").removeClass("hidden"),$("#spinner").hide())},!1),!1})}function homeScan(){$(".scrape-button").on("click",function(e){e.preventDefault(),$("#spinner").show(),table.order([0,"asc"]).draw();for(var t=[],a=0;a<5;a++)t.push(table.rows().data()[a][1].match(/href='(.+)'/)[0].replace("href=",""));var n=new EventSource("/home-scan?links="+encodeURIComponent(t.join(";")));$("#messages").empty();var o=0,s=0;return n.addEventListener("message",function(e){var t=JSON.parse(JSON.parse(e.data)),a=t.shares,n=t.message;if(n!=undefined){var i="";i+='  <div id="custom-notification-message-'+s+'" data-notify-close="true" data-notify-position="top-left" data-notify-type="success" data-notify-msg=\'<i class="icon-info-sign"></i> '+n+"'></div>",i+="",3==$("#messages #message-box").length&&$("#messages #message-box")[0].remove(),$("#messages").append(i),SEMICOLON.widget.notifications(jQuery("#custom-notification-message-"+s)),s+=1}a!=undefined&&(a=JSON.parse(a),data=table.row(o).data(),data[2]=a.total,data[3]=a.facebook,data[4]=a.twitter,data[5]=a.linkedin,data[6]=a.pinterest,data[7]=a.google,data[8]=a.comments,$("#datatable1").dataTable().fnUpdate(data,o,undefined,!1),o+=1)},!1),n.addEventListener("error",function(e){e.eventPhase==EventSource.CLOSED&&(n.close(),$("#spinner").hide(),$("#register").modal("show"))},!1),!1})}$(document).ready(function(){submitHomeForm(),homeScan()});